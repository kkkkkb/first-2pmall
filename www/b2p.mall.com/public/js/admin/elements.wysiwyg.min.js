!function(t,e){t.fn.ace_wysiwyg=function(e,i){var n=t.extend({speech_button:!0,wysiwyg:{}},e),a=["#ac725e","#d06b64","#f83a22","#fa573c","#ff7537","#ffad46","#42d692","#16a765","#7bd148","#b3dc6c","#fbe983","#fad165","#92e1c0","#9fe1e7","#9fc6e7","#4986e7","#9a9cff","#b99aff","#c2c2c2","#cabdbf","#cca6ac","#f691b2","#cd74e6","#a47ae2","#444444"],o={font:{values:["Arial","Courier","Comic Sans MS","Helvetica","Open Sans","Tahoma","Verdana"],icon:"fa fa-font",title:"字体"},fontSize:{values:{5:"Huge",3:"Normal",1:"Small"},icon:"fa fa-text-height",title:"字体大小"},bold:{icon:"fa fa-bold",title:"粗体 (Ctrl/Cmd+B)"},italic:{icon:"fa fa-italic",title:"斜体 (Ctrl/Cmd+I)"},strikethrough:{icon:"fa fa-strikethrough",title:"删除线"},underline:{icon:"fa fa-underline",title:"强调线"},insertunorderedlist:{icon:"fa fa-list-ul",title:"符号列表"},insertorderedlist:{icon:"fa fa-list-ol",title:"数字列表"},outdent:{icon:"fa fa-outdent",title:"减少缩进 (Shift+Tab)"},indent:{icon:"fa fa-indent",title:"缩进 (Tab)"},justifyleft:{icon:"fa fa-align-left",title:"居左 (Ctrl/Cmd+L)"},justifycenter:{icon:"fa fa-align-center",title:"居中 (Ctrl/Cmd+E)"},justifyright:{icon:"fa fa-align-right",title:"居右 (Ctrl/Cmd+R)"},justifyfull:{icon:"fa fa-align-justify",title:"两边对齐 (Ctrl/Cmd+J)"},createLink:{icon:"fa fa-link",title:"超链接",button_text:"Add",placeholder:"URL",button_class:"btn-primary"},unlink:{icon:"fa fa-chain-broken",title:"移除超链接"},insertImage:{icon:"fa fa-picture-o",title:"插入图片",button_text:'<i class="'+ace.vars.icon+'fa fa-file"></i> 选择图片',placeholder:"图片地址",button_insert:"插入",button_class:"btn-success",button_insert_class:"btn-primary",choose_file:!0},foreColor:{values:a,title:"颜色"},backColor:{values:a,title:"更改背景颜色"},undo:{icon:"fa fa-undo",title:"撤销 (Ctrl/Cmd+Z)"},redo:{icon:"fa fa-repeat",title:"恢复 (Ctrl/Cmd+Y)"},viewSource:{icon:"fa fa-code",title:"查看源码"}},l=n.toolbar||["font",null,"fontSize",null,"bold","italic","strikethrough","underline",null,"insertunorderedlist","insertorderedlist","outdent","indent",null,"justifyleft","justifycenter","justifyright","justifyfull",null,"createLink","unlink",null,"insertImage",null,"foreColor",null,"undo","redo",null,"viewSource"];return this.each(function(){var e=' <div class="wysiwyg-toolbar btn-toolbar center"> <div class="btn-group"> ';for(var i in l)if(l.hasOwnProperty(i)){var a=l[i];if(null===a){e+=' </div> <div class="btn-group"> ';continue}if("string"==typeof a&&a in o)a=o[a],a.name=l[i];else{if(!("object"==typeof a&&a.name in o))continue;a=t.extend(o[a.name],a)}var s="className"in a?a.className:"btn-default";switch(a.name){case"font":e+=' <a class="btn btn-sm '+s+' dropdown-toggle" data-toggle="dropdown" title="'+a.title+'"><i class="'+ace.vars.icon+a.icon+'"></i><i class="'+ace.vars.icon+'fa fa-angle-down icon-on-right"></i></a> ',e+=' <ul class="dropdown-menu dropdown-light dropdown-caret">';for(var c in a.values)a.values.hasOwnProperty(c)&&(e+=' <li><a data-edit="fontName '+a.values[c]+'" style="font-family:\''+a.values[c]+"'\">"+a.values[c]+"</a></li> ");e+=" </ul>";break;case"fontSize":e+=' <a class="btn btn-sm '+s+' dropdown-toggle" data-toggle="dropdown" title="'+a.title+'"><i class="'+ace.vars.icon+a.icon+'"></i>&nbsp;<i class="'+ace.vars.icon+'fa fa-angle-down icon-on-right"></i></a> ',e+=' <ul class="dropdown-menu dropdown-light dropdown-caret"> ';for(var r in a.values)a.values.hasOwnProperty(r)&&(e+=' <li><a data-edit="fontSize '+r+'"><font size="'+r+'">'+a.values[r]+"</font></a></li> ");e+=" </ul> ";break;case"createLink":e+=' <div class="btn-group"> <a class="btn btn-sm '+s+' dropdown-toggle" data-toggle="dropdown" title="'+a.title+'"><i class="'+ace.vars.icon+a.icon+'"></i></a> ',e+=' <div class="dropdown-menu dropdown-caret dropdown-menu-right">\t\t\t\t\t\t\t <div class="input-group">\t\t\t\t\t\t\t\t<input class="form-control" placeholder="'+a.placeholder+'" type="text" data-edit="'+a.name+'" />\t\t\t\t\t\t\t\t<span class="input-group-btn">\t\t\t\t\t\t\t\t\t<button class="btn btn-sm '+a.button_class+'" type="button">'+a.button_text+"</button>\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t </div>\t\t\t\t\t\t</div> </div>";break;case"insertImage":e+=' <div class="btn-group"> <a class="btn btn-sm '+s+' dropdown-toggle" data-toggle="dropdown" title="'+a.title+'"><i class="'+ace.vars.icon+a.icon+'"></i></a> ',e+=' <div class="dropdown-menu dropdown-caret dropdown-menu-right">\t\t\t\t\t\t\t <div class="input-group">\t\t\t\t\t\t\t\t<input class="form-control" placeholder="'+a.placeholder+'" type="text" data-edit="'+a.name+'" />\t\t\t\t\t\t\t\t<span class="input-group-btn">\t\t\t\t\t\t\t\t\t<button class="btn btn-sm '+a.button_insert_class+'" type="button">'+a.button_insert+"</button>\t\t\t\t\t\t\t\t</span>\t\t\t\t\t\t\t </div>",a.choose_file&&"FileReader"in window&&(e+='<div class="space-2"></div>\t\t\t\t\t\t\t <label class="center block no-margin-bottom">\t\t\t\t\t\t\t\t<button class="btn btn-sm '+a.button_class+' wysiwyg-choose-file" type="button">'+a.button_text+'</button>\t\t\t\t\t\t\t\t<input type="file" data-edit="'+a.name+'" />\t\t\t\t\t\t\t  </label>'),e+=" </div> </div>";break;case"foreColor":case"backColor":e+=' <select class="hide wysiwyg_colorpicker" title="'+a.title+'"> ',t.each(a.values,function(t,i){e+=' <option value="'+i+'">'+i+"</option> "}),e+=" </select> ",e+=' <input style="display:none;" disabled class="hide" type="text" data-edit="'+a.name+'" /> ';break;case"viewSource":e+=' <a class="btn btn-sm '+s+'" data-view="source" title="'+a.title+'"><i class="'+ace.vars.icon+a.icon+'"></i></a> ';break;default:e+=' <a class="btn btn-sm '+s+'" data-edit="'+a.name+'" title="'+a.title+'"><i class="'+ace.vars.icon+a.icon+'"></i></a> '}}e+=" </div> ";var d;n.speech_button&&"onwebkitspeechchange"in(d=document.createElement("input"))&&(e+=' <input class="wysiwyg-speech-input" type="text" data-edit="inserttext" x-webkit-speech />'),d=null,e+=" </div> ",e=n.toolbar_place?n.toolbar_place.call(this,e):t(this).before(e).prev(),t.fn.tooltip&&e.find("a[title]").tooltip({animation:!1,container:"body"}),e.find(".dropdown-menu input[type=text]").on("click",function(){return!1}).on("change",function(){t(this).closest(".dropdown-menu").siblings(".dropdown-toggle").dropdown("toggle")}).on("keydown",function(e){27==e.which?(this.value="",t(this).change()):13==e.which&&(e.preventDefault(),e.stopPropagation(),t(this).change())}),e.find("input[type=file]").prev().on(ace.click_event,function(e){t(this).next().click()}),e.find(".wysiwyg_colorpicker").each(function(){var e=t(this).ace_colorpicker({pull_right:!0}).change(function(){t(this).nextAll("input").eq(0).val(this.value).change()}).next().find(".btn-colorpicker");t.fn.tooltip&&e.tooltip({title:this.title,animation:!1,container:"body"})});var u=t(this),f=!1;e.find("a[data-view=source]").on("click",function(e){if(e.preventDefault(),f){var i=u.next();u.html(i.val()).show(),i.remove(),t(this).removeClass("active")}else t("<textarea />").css({width:u.outerWidth(),height:u.outerHeight()}).val(u.html()).insertAfter(u),u.hide(),t(this).addClass("active");f=!f});var p=t.extend({},{activeToolbarClass:"active",toolbarSelector:e},n.wysiwyg||{});t(this).wysiwyg(p)}),this}}(window.jQuery);