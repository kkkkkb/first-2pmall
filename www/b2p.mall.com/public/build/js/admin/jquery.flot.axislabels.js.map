{"version":3,"sources":["jquery.flot.axislabels.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"jquery.flot.axislabels.js","sourcesContent":["/*\r\nAxis Labels Plugin for flot.\r\nhttp://github.com/markrcote/flot-axislabels\r\n\r\nOriginal code is Copyright (c) 2010 Xuan Luo.\r\nOriginal code was released under the GPLv3 license by Xuan Luo, September 2010.\r\nOriginal code was rereleased under the MIT license by Xuan Luo, April 2012.\r\n\r\nImprovements by Mark Cote.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining\r\na copy of this software and associated documentation files (the\r\n\"Software\"), to deal in the Software without restriction, including\r\nwithout limitation the rights to use, copy, modify, merge, publish,\r\ndistribute, sublicense, and/or sell copies of the Software, and to\r\npermit persons to whom the Software is furnished to do so, subject to\r\nthe following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be\r\nincluded in all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\nLIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\nOF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\nWITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n*/\r\n(function ($) {\r\n    var options = {};\r\n\r\n    function canvasSupported() {\r\n        return !!document.createElement('canvas').getContext;\r\n    }\r\n\r\n    function canvasTextSupported() {\r\n        if (!canvasSupported()) {\r\n            return false;\r\n        }\r\n        var dummy_canvas = document.createElement('canvas');\r\n        var context = dummy_canvas.getContext('2d');\r\n        return typeof context.fillText == 'function';\r\n    }\r\n\r\n    function css3TransitionSupported() {\r\n        var div = document.createElement('div');\r\n        return typeof div.style.MozTransition != 'undefined'    // Gecko\r\n            || typeof div.style.OTransition != 'undefined'      // Opera\r\n            || typeof div.style.webkitTransition != 'undefined' // WebKit\r\n            || typeof div.style.transition != 'undefined';\r\n    }\r\n\r\n\r\n    function AxisLabel(axisName, position, padding, plot, opts) {\r\n        this.axisName = axisName;\r\n        this.position = position;\r\n        this.padding = padding;\r\n        this.plot = plot;\r\n        this.opts = opts;\r\n        this.width = 0;\r\n        this.height = 0;\r\n    }\r\n\r\n\r\n    CanvasAxisLabel.prototype = new AxisLabel();\r\n    CanvasAxisLabel.prototype.constructor = CanvasAxisLabel;\r\n    function CanvasAxisLabel(axisName, position, padding, plot, opts) {\r\n        AxisLabel.prototype.constructor.call(this, axisName, position, padding,\r\n                                             plot, opts);\r\n    }\r\n\r\n    CanvasAxisLabel.prototype.calculateSize = function () {\r\n        if (!this.opts.axisLabelFontSizePixels)\r\n            this.opts.axisLabelFontSizePixels = 14;\r\n        if (!this.opts.axisLabelFontFamily)\r\n            this.opts.axisLabelFontFamily = 'sans-serif';\r\n\r\n        var textWidth = this.opts.axisLabelFontSizePixels + this.padding;\r\n        var textHeight = this.opts.axisLabelFontSizePixels + this.padding;\r\n        if (this.position == 'left' || this.position == 'right') {\r\n            this.width = this.opts.axisLabelFontSizePixels + this.padding;\r\n            this.height = 0;\r\n        } else {\r\n            this.width = 0;\r\n            this.height = this.opts.axisLabelFontSizePixels + this.padding;\r\n        }\r\n    };\r\n\r\n    CanvasAxisLabel.prototype.draw = function (box) {\r\n        var ctx = this.plot.getCanvas().getContext('2d');\r\n        ctx.save();\r\n        ctx.font = this.opts.axisLabelFontSizePixels + 'px ' +\r\n            this.opts.axisLabelFontFamily;\r\n        var width = ctx.measureText(this.opts.axisLabel).width;\r\n        var height = this.opts.axisLabelFontSizePixels;\r\n        var x, y, angle = 0;\r\n        if (this.position == 'top') {\r\n            x = box.left + box.width / 2 - width / 2;\r\n            y = box.top + height * 0.72;\r\n        } else if (this.position == 'bottom') {\r\n            x = box.left + box.width / 2 - width / 2;\r\n            y = box.top + box.height - height * 0.72;\r\n        } else if (this.position == 'left') {\r\n            x = box.left + height * 0.72;\r\n            y = box.height / 2 + box.top + width / 2;\r\n            angle = -Math.PI / 2;\r\n        } else if (this.position == 'right') {\r\n            x = box.left + box.width - height * 0.72;\r\n            y = box.height / 2 + box.top - width / 2;\r\n            angle = Math.PI / 2;\r\n        }\r\n        ctx.translate(x, y);\r\n        ctx.rotate(angle);\r\n        ctx.fillText(this.opts.axisLabel, 0, 0);\r\n        ctx.restore();\r\n    };\r\n\r\n\r\n    HtmlAxisLabel.prototype = new AxisLabel();\r\n    HtmlAxisLabel.prototype.constructor = HtmlAxisLabel;\r\n    function HtmlAxisLabel(axisName, position, padding, plot, opts) {\r\n        AxisLabel.prototype.constructor.call(this, axisName, position,\r\n                                             padding, plot, opts);\r\n    }\r\n\r\n    HtmlAxisLabel.prototype.calculateSize = function () {\r\n        var elem = $('<div class=\"axisLabels\" style=\"position:absolute;\">' +\r\n                     this.opts.axisLabel + '</div>');\r\n        this.plot.getPlaceholder().append(elem);\r\n        // store height and width of label itself, for use in draw()\r\n        this.labelWidth = elem.outerWidth(true);\r\n        this.labelHeight = elem.outerHeight(true);\r\n        elem.remove();\r\n\r\n        this.width = this.height = 0;\r\n        if (this.position == 'left' || this.position == 'right') {\r\n            this.width = this.labelWidth + this.padding;\r\n        } else {\r\n            this.height = this.labelHeight + this.padding;\r\n        }\r\n    };\r\n\r\n    HtmlAxisLabel.prototype.draw = function (box) {\r\n        this.plot.getPlaceholder().find('#' + this.axisName + 'Label').remove();\r\n        var elem = $('<div id=\"' + this.axisName +\r\n                     'Label\" \" class=\"axisLabels\" style=\"position:absolute;\">'\r\n                     + this.opts.axisLabel + '</div>');\r\n        this.plot.getPlaceholder().append(elem);\r\n        if (this.position == 'top') {\r\n            elem.css('left', box.left + box.width / 2 - this.labelWidth / 2 + 'px');\r\n            elem.css('top', box.top + 'px');\r\n        } else if (this.position == 'bottom') {\r\n            elem.css('left', box.left + box.width / 2 - this.labelWidth / 2 + 'px');\r\n            elem.css('top', box.top + box.height - this.labelHeight + 'px');\r\n        } else if (this.position == 'left') {\r\n            elem.css('top', box.top + box.height / 2 - this.labelHeight / 2 + 'px');\r\n            elem.css('left', box.left + 'px');\r\n        } else if (this.position == 'right') {\r\n            elem.css('top', box.top + box.height / 2 - this.labelHeight / 2 + 'px');\r\n            elem.css('left', box.left + box.width - this.labelWidth + 'px');\r\n        }\r\n    };\r\n\r\n\r\n    CssTransformAxisLabel.prototype = new HtmlAxisLabel();\r\n    CssTransformAxisLabel.prototype.constructor = CssTransformAxisLabel;\r\n    function CssTransformAxisLabel(axisName, position, padding, plot, opts) {\r\n        HtmlAxisLabel.prototype.constructor.call(this, axisName, position,\r\n                                                 padding, plot, opts);\r\n    }\r\n\r\n    CssTransformAxisLabel.prototype.calculateSize = function () {\r\n        HtmlAxisLabel.prototype.calculateSize.call(this);\r\n        this.width = this.height = 0;\r\n        if (this.position == 'left' || this.position == 'right') {\r\n            this.width = this.labelHeight + this.padding;\r\n        } else {\r\n            this.height = this.labelHeight + this.padding;\r\n        }\r\n    };\r\n\r\n    CssTransformAxisLabel.prototype.transforms = function (degrees, x, y) {\r\n        var stransforms = {\r\n            '-moz-transform': '',\r\n            '-webkit-transform': '',\r\n            '-o-transform': '',\r\n            '-ms-transform': ''\r\n        };\r\n        if (x != 0 || y != 0) {\r\n            var stdTranslate = ' translate(' + x + 'px, ' + y + 'px)';\r\n            stransforms['-moz-transform'] += stdTranslate;\r\n            stransforms['-webkit-transform'] += stdTranslate;\r\n            stransforms['-o-transform'] += stdTranslate;\r\n            stransforms['-ms-transform'] += stdTranslate;\r\n        }\r\n        if (degrees != 0) {\r\n            var rotation = degrees / 90;\r\n            var stdRotate = ' rotate(' + degrees + 'deg)';\r\n            stransforms['-moz-transform'] += stdRotate;\r\n            stransforms['-webkit-transform'] += stdRotate;\r\n            stransforms['-o-transform'] += stdRotate;\r\n            stransforms['-ms-transform'] += stdRotate;\r\n        }\r\n        var s = 'top: 0; left: 0; ';\r\n        for (var prop in stransforms) {\r\n            if (stransforms[prop]) {\r\n                s += prop + ':' + stransforms[prop] + ';';\r\n            }\r\n        }\r\n        s += ';';\r\n        return s;\r\n    };\r\n\r\n    CssTransformAxisLabel.prototype.calculateOffsets = function (box) {\r\n        var offsets = { x: 0, y: 0, degrees: 0 };\r\n        if (this.position == 'bottom') {\r\n            offsets.x = box.left + box.width / 2 - this.labelWidth / 2;\r\n            offsets.y = box.top + box.height - this.labelHeight;\r\n        } else if (this.position == 'top') {\r\n            offsets.x = box.left + box.width / 2 - this.labelWidth / 2;\r\n            offsets.y = box.top;\r\n        } else if (this.position == 'left') {\r\n            offsets.degrees = -90;\r\n            offsets.x = box.left - this.labelWidth / 2 + this.labelHeight / 2;\r\n            offsets.y = box.height / 2 + box.top;\r\n        } else if (this.position == 'right') {\r\n            offsets.degrees = 90;\r\n            offsets.x = box.left + box.width - this.labelWidth / 2\r\n                        - this.labelHeight / 2;\r\n            offsets.y = box.height / 2 + box.top;\r\n        }\r\n        return offsets;\r\n    };\r\n\r\n    CssTransformAxisLabel.prototype.draw = function (box) {\r\n        this.plot.getPlaceholder().find(\".\" + this.axisName + \"Label\").remove();\r\n        var offsets = this.calculateOffsets(box);\r\n        var elem = $('<div class=\"axisLabels ' + this.axisName +\r\n                     'Label\" style=\"position:absolute; ' +\r\n                     this.transforms(offsets.degrees, offsets.x, offsets.y) +\r\n                     '\">' + this.opts.axisLabel + '</div>');\r\n        this.plot.getPlaceholder().append(elem);\r\n    };\r\n\r\n\r\n    IeTransformAxisLabel.prototype = new CssTransformAxisLabel();\r\n    IeTransformAxisLabel.prototype.constructor = IeTransformAxisLabel;\r\n    function IeTransformAxisLabel(axisName, position, padding, plot, opts) {\r\n        CssTransformAxisLabel.prototype.constructor.call(this, axisName,\r\n                                                         position, padding,\r\n                                                         plot, opts);\r\n        this.requiresResize = false;\r\n    }\r\n\r\n    IeTransformAxisLabel.prototype.transforms = function (degrees, x, y) {\r\n        // I didn't feel like learning the crazy Matrix stuff, so this uses\r\n        // a combination of the rotation transform and CSS positioning.\r\n        var s = '';\r\n        if (degrees != 0) {\r\n            var rotation = degrees / 90;\r\n            while (rotation < 0) {\r\n                rotation += 4;\r\n            }\r\n            s += ' filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=' + rotation + '); ';\r\n            // see below\r\n            this.requiresResize = (this.position == 'right');\r\n        }\r\n        if (x != 0) {\r\n            s += 'left: ' + x + 'px; ';\r\n        }\r\n        if (y != 0) {\r\n            s += 'top: ' + y + 'px; ';\r\n        }\r\n        return s;\r\n    };\r\n\r\n    IeTransformAxisLabel.prototype.calculateOffsets = function (box) {\r\n        var offsets = CssTransformAxisLabel.prototype.calculateOffsets.call(\r\n                          this, box);\r\n        // adjust some values to take into account differences between\r\n        // CSS and IE rotations.\r\n        if (this.position == 'top') {\r\n            // FIXME: not sure why, but placing this exactly at the top causes \r\n            // the top axis label to flip to the bottom...\r\n            offsets.y = box.top + 1;\r\n        } else if (this.position == 'left') {\r\n            offsets.x = box.left;\r\n            offsets.y = box.height / 2 + box.top - this.labelWidth / 2;\r\n        } else if (this.position == 'right') {\r\n            offsets.x = box.left + box.width - this.labelHeight;\r\n            offsets.y = box.height / 2 + box.top - this.labelWidth / 2;\r\n        }\r\n        return offsets;\r\n    };\r\n\r\n    IeTransformAxisLabel.prototype.draw = function (box) {\r\n        CssTransformAxisLabel.prototype.draw.call(this, box);\r\n        if (this.requiresResize) {\r\n            var elem = this.plot.getPlaceholder().find(\".\" + this.axisName + \"Label\");\r\n            // Since we used CSS positioning instead of transforms for\r\n            // translating the element, and since the positioning is done\r\n            // before any rotations, we have to reset the width and height\r\n            // in case the browser wrapped the text (specifically for the\r\n            // y2axis).\r\n            elem.css('width', this.labelWidth);\r\n            elem.css('height', this.labelHeight);\r\n        }\r\n    };\r\n\r\n\r\n    function init(plot) {\r\n        // This is kind of a hack. There are no hooks in Flot between\r\n        // the creation and measuring of the ticks (setTicks, measureTickLabels\r\n        // in setupGrid() ) and the drawing of the ticks and plot box\r\n        // (insertAxisLabels in setupGrid() ).\r\n        //\r\n        // Therefore, we use a trick where we run the draw routine twice:\r\n        // the first time to get the tick measurements, so that we can change\r\n        // them, and then have it draw it again.\r\n        var secondPass = false;\r\n\r\n        var axisLabels = {};\r\n        var axisOffsetCounts = { left: 0, right: 0, top: 0, bottom: 0 };\r\n\r\n        var defaultPadding = 2;  // padding between axis and tick labels\r\n        plot.hooks.draw.push(function (plot, ctx) {\r\n            if (!secondPass) {\r\n                // MEASURE AND SET OPTIONS\r\n                $.each(plot.getAxes(), function (axisName, axis) {\r\n                    var opts = axis.options // Flot 0.7\r\n                        || plot.getOptions()[axisName]; // Flot 0.6\r\n                    if (!opts || !opts.axisLabel)\r\n                        return;\r\n\r\n                    var renderer = null;\r\n\r\n                    if (!opts.axisLabelUseHtml &&\r\n                        navigator.appName == 'Microsoft Internet Explorer') {\r\n                        var ua = navigator.userAgent;\r\n                        var re = new RegExp(\"MSIE ([0-9]{1,}[\\.0-9]{0,})\");\r\n                        if (re.exec(ua) != null) {\r\n                            rv = parseFloat(RegExp.$1);\r\n                        }\r\n                        if (rv >= 9 && !opts.axisLabelUseCanvas && !opts.axisLabelUseHtml) {\r\n                            renderer = CssTransformAxisLabel;\r\n                        } else if (!opts.axisLabelUseCanvas && !opts.axisLabelUseHtml) {\r\n                            renderer = IeTransformAxisLabel;\r\n                        } else if (opts.axisLabelUseCanvas) {\r\n                            renderer = CanvasAxisLabel;\r\n                        } else {\r\n                            renderer = HtmlAxisLabel;\r\n                        }\r\n                    } else {\r\n                        if (opts.axisLabelUseHtml || (!css3TransitionSupported() && !canvasTextSupported()) && !opts.axisLabelUseCanvas) {\r\n                            renderer = HtmlAxisLabel;\r\n                        } else if (opts.axisLabelUseCanvas || !css3TransitionSupported()) {\r\n                            renderer = CanvasAxisLabel;\r\n                        } else {\r\n                            renderer = CssTransformAxisLabel;\r\n                        }\r\n                    }\r\n\r\n                    var padding = opts.axisLabelPadding === undefined ?\r\n                                  defaultPadding : opts.axisLabelPadding;\r\n\r\n                    axisLabels[axisName] = new renderer(axisName,\r\n                                                        axis.position, padding,\r\n                                                        plot, opts);\r\n\r\n                    // flot interprets axis.labelHeight and .labelWidth as\r\n                    // the height and width of the tick labels. We increase\r\n                    // these values to make room for the axis label and\r\n                    // padding.\r\n\r\n                    axisLabels[axisName].calculateSize();\r\n\r\n                    // AxisLabel.height and .width are the size of the\r\n                    // axis label and padding.\r\n                    axis.labelHeight += axisLabels[axisName].height;\r\n                    axis.labelWidth += axisLabels[axisName].width;\r\n                    opts.labelHeight = axis.labelHeight;\r\n                    opts.labelWidth = axis.labelWidth;\r\n                });\r\n                // re-draw with new label widths and heights\r\n                secondPass = true;\r\n                plot.setupGrid();\r\n                plot.draw();\r\n            } else {\r\n                // DRAW\r\n                $.each(plot.getAxes(), function (axisName, axis) {\r\n                    var opts = axis.options // Flot 0.7\r\n                        || plot.getOptions()[axisName]; // Flot 0.6\r\n                    if (!opts || !opts.axisLabel)\r\n                        return;\r\n\r\n                    axisLabels[axisName].draw(axis.box);\r\n                });\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    $.plot.plugins.push({\r\n        init: init,\r\n        options: options,\r\n        name: 'axisLabels',\r\n        version: '2.0b0'\r\n    });\r\n})(jQuery);"],"sourceRoot":"/source/"}