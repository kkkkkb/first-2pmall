!function(a,t){"use strict";var o=[];a(".sku_box a").on("click",function(){function t(t,o){var i={goods_id:goodsData.goods_id,attr_type:t,attr_id:o};a("[name=buy_but]").attr("href","javascript:void(0);"),a("[data-type="+t+"] a").removeClass("invalid"),a.ajax({url:d,type:"POST",dataType:"json",data:i}).done(function(o){"err_code"in o?JOEY.alert({title:"系统提示",content:o.msg,singleBtn:!0}):("size"==t&&(a("[data-type=color] a").addClass("invalid").removeClass("cur"),a.each(o,function(){a("[data-type=color]").find("#sku_item_"+this.id).removeClass("invalid")})),"color"==t&&(a("[data-type=size] a").addClass("invalid").removeClass("cur"),a.each(o,function(){a("[data-type=size]").find("#sku_item_"+this.id).removeClass("invalid")})))}).fail(function(a){})}var i=a(this).data("id"),d=a(this).parents("#goods_main_box").data("atr-url"),e=a(this).parents("#goods_main_box").data("url"),s=a(this).parent().data("type"),n=!1;if(a(this).addClass("cur").siblings("a").removeClass("cur"),a.inArray(s,o)==-1&&o.push(s),o.length>=2&&(n=!0),n&&o.length>1){var r={goods_id:goodsData.goods_id,color_attr_val_id:a("[data-type=color] a.cur").data("id"),size_attr_val_id:a("[data-type=size] a.cur").data("id")};a.ajax({url:e,type:"POST",dataType:"json",data:r}).done(function(o){if(o.err_code)t(s,i);else{a("[name=shop_price]").html("&yen;"+parseFloat(o.shop_price).toFixed(2)),a("[name=market_price]").html("&yen;"+parseFloat(o.market_price).toFixed(2)),a("[name=stock]").html("库存："+o.sku_number+"件");var d=goodsData.buy_link+"?goods_id="+goodsData.goods_id+"&sku_id="+o.id+(goodsData.group_id&&goodsData.is_group?"&group_id="+goodsData.group_id:"");a("[name=buy_but]").attr("href",d)}}).fail(function(a){})}else t(s,i)}),a("[name=group_end]").on("click",function(){JOEY.alert({title:"系统提示",content:"该拼团已结束，是否重新创建拼团？",sure:function(){window.location.href=goodsData.buy_link+"/?goods_id="+goodsData.goods_id+"&sku_id="+goodsData.sku_id}})})}(jQuery);